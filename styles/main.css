@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;1,400;1,600&family=Cinzel:wght@400;500;700&family=Cormorant+Garamond:ital,wght@0,500;0,600;1,500&family=Lato:wght@400;700&family=JetBrains+Mono:wght@400&display=swap');

:root {
    --bg-deep: #020202;
    --glass-bg: rgba(20, 20, 20, 0.95);
    --glass-border: 1px solid rgba(255, 255, 255, 0.1);
    --text-main: #f3f3f3;
    --text-sub: #a1a1aa;
    --accent: #ffdb4d;
    --input-bg: rgba(30, 30, 30, 0.8);
}

body.light {
    --bg-deep: #f8f5fa;
    --glass-bg: rgba(255, 255, 255, 0.95);
    --glass-border: 1px solid rgba(0, 0, 0, 0.1);
    --text-main: #2e1065;
    --text-sub: #52525b;
    --accent: #b45309;
    --input-bg: #ffffff;
}

/* FLUID LAYOUT (Mobile Optimization) */
html, body { 
    height: 100dvh; /* Dynamic height for mobile browsers */
    width: 100%; margin: 0; overflow: hidden; 
    background: var(--bg-deep); color: var(--text-main); font-family: 'Inter', sans-serif; 
    transition: background 0.3s, color 0.3s;
    touch-action: manipulation; /* Improves tap response */
}

/* COMPONENTS */
.glass-panel { background: var(--glass-bg); border: var(--glass-border); border-radius: 12px; backdrop-filter: blur(10px); }
.custom-scrollbar::-webkit-scrollbar { width: 4px; }
.custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(128,128,128,0.2); border-radius: 2px; }
#dustCanvas { position: fixed; inset: 0; pointer-events: none; mix-blend-mode: overlay; z-index: 0; }

/* BUTTONS */
.icon-btn { padding: 0.75rem; color: var(--text-sub); border-radius: 0.5rem; transition: all 0.2s; cursor: pointer; }
.icon-btn:hover { color: var(--accent); background: rgba(255,255,255,0.05); }
.nav-btn { width: 100%; text-align: left; padding: 1rem 0.75rem; font-size: 0.8rem; color: var(--text-sub); border-radius: 0.5rem; transition: 0.2s; display: flex; align-items: center; gap: 0.75rem; font-weight: 500; }
.nav-btn:hover { background: rgba(255,255,255,0.03); color: var(--text-main); }
.ctx-btn { width: 100%; text-align: left; padding: 0.75rem 1rem; font-size: 0.8rem; color: #d1d5db; }
.ctx-btn:hover { background: rgba(255,255,255,0.1); color: white; }

/* TREE (Larger Tap Targets) */
.tree-node { padding: 10px 12px; border-radius: 8px; cursor: pointer; font-size: 0.9rem; color: var(--text-sub); display: flex; align-items: center; user-select: none; -webkit-touch-callout: none; transition: 0.2s; }
.tree-node:hover { background: rgba(255,255,255,0.03); color: var(--text-main); }
.tree-node.active { background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), transparent); border-left: 3px solid var(--accent); color: var(--accent); font-weight: 600; }
.tree-children { margin-left: 14px; border-left: 1px solid var(--glass-border); }

/* EDITOR */
.typewriter-active textarea { 
    padding-top: 50vh !important; 
    padding-bottom: 50vh !important; 
    scroll-behavior: smooth; 
}
@media (max-width: 768px) {
    /* Adjust Typewriter center for virtual keyboard space */
    .typewriter-active textarea { padding-top: 30vh !important; padding-bottom: 40vh !important; }
}
textarea:focus { outline: none; }

/* MOBILE DRAWER & LAYOUT */
#sidebar { 
    position: fixed; top: 0; left: 0; bottom: 0; 
    width: 85%; max-width: 300px; /* Wider drawer on mobile */
    z-index: 100; background: var(--bg-deep); border-right: 1px solid var(--glass-border); 
    transform: translateX(-100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    display: flex; flex-direction: column; 
    padding-top: env(safe-area-inset-top); /* iPhone Notch Safety */
}
#sidebar.open { transform: translateX(0); }
#drawerOverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 90; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(2px); }
#drawerOverlay.active { opacity: 1; pointer-events: auto; }

#inspector {
    width: 100%; max-width: 350px; /* Full width on tiny screens */
    padding-top: env(safe-area-inset-top);
}

/* ANIMATIONS */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.animate-fade-in { animation: fadeIn 0.4s cubic-bezier(0.19, 1, 0.22, 1); }
#toast.active { opacity: 1; transform: translate(-50%, -20px) scale(1); }
#ctxMenu.active { opacity: 1; transform: scale(1); }
